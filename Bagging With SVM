{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"executionInfo":{"elapsed":5349,"status":"ok","timestamp":1723525268041,"user":{"displayName":"Taseer Mehboob","userId":"03813316000743101524"},"user_tz":-300},"id":"GVb73nlOI_wm"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","import matplotlib.pyplot as plt\n","import seaborn as sns\n","import time\n","from tqdm import tqdm"]},{"cell_type":"code","execution_count":2,"metadata":{"executionInfo":{"elapsed":25,"status":"ok","timestamp":1723525268044,"user":{"displayName":"Taseer Mehboob","userId":"03813316000743101524"},"user_tz":-300},"id":"sdUQ0hO2JoFy"},"outputs":[],"source":["df = pd.read_csv('/content/realheart.csv')\n","X = df.drop(columns = 'target')\n","y = df['target']"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"4MmmfuBAJjuo","outputId":"ac3f9d29-5781-4fd0-d086-fe263725c7d3","executionInfo":{"status":"ok","timestamp":1723532595434,"user_tz":-300,"elapsed":71342,"user":{"displayName":"Taseer Mehboob","userId":"03813316000743101524"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["Fitting 5 folds for each of 16 candidates, totalling 80 fits\n","Training time: 7326.22 seconds\n","Best Parameters: {'estimator__C': 1, 'estimator__degree': 3, 'estimator__gamma': 'scale', 'estimator__kernel': 'linear'}\n","Best Cross-Validation Score: 0.8429\n"]}],"source":["# Step 1: Import necessary libraries\n","from sklearn.svm import SVC\n","from sklearn.ensemble import BaggingClassifier\n","from sklearn.model_selection import GridSearchCV, train_test_split\n","from sklearn.metrics import accuracy_score\n","\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","\n","# Step 3: Set up the SVM model\n","svm = SVC()\n","\n","# Step 4: Define the parameter grid for GridSearchCV\n","param_grid = {\n","    'C': [1, 3],\n","    'kernel': ['poly', 'linear'],\n","    'gamma': ['scale', 'auto'],\n","    'degree': [3,5]\n","}\n","\n","# Step 5: Create the Bagging Classifier with the SVM as the base estimator\n","bagging_clf = BaggingClassifier(estimator=svm, n_estimators=10, random_state=42)\n","\n","# Step 6: Set up GridSearchCV\n","grid_search = GridSearchCV(estimator=bagging_clf, param_grid={\n","    'estimator__C': param_grid['C'],\n","    'estimator__kernel': param_grid['kernel'],\n","    'estimator__gamma': param_grid['gamma'],\n","    'estimator__degree':param_grid['degree']\n","}, cv=5, scoring='accuracy', n_jobs=-1, verbose = True)\n","\n","start_time = time.time()\n","\n","# Step 7: Fit GridSearchCV to the training data\n","grid_search.fit(X_train, y_train)\n","\n","end_time = time.time()\n","training_time = end_time - start_time\n","\n","print(f\"Training time: {training_time:.2f} seconds\")\n","\n","# Step 8: Get the best parameters and the best model\n","best_params = grid_search.best_params_\n","best_model = grid_search.best_estimator_\n","\n","print(f'Best Parameters: {best_params}')\n","print(f'Best Cross-Validation Score: {grid_search.best_score_:.4f}')\n","\n"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"h-bsCXMTJ1dt","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1723532739156,"user_tz":-300,"elapsed":496,"user":{"displayName":"Taseer Mehboob","userId":"03813316000743101524"}},"outputId":"0289b35b-ec30-473b-e65a-b34e7b7b415d"},"outputs":[{"output_type":"stream","name":"stdout","text":["Training Accuracy: 0.8430\n","Testing Accuracy: 0.8852\n"]}],"source":["# Step 9: Evaluate the model\n","y_train_pred = best_model.predict(X_train)\n","y_test_pred = best_model.predict(X_test)\n","\n","train_accuracy = accuracy_score(y_train, y_train_pred)\n","test_accuracy = accuracy_score(y_test, y_test_pred)\n","\n","print(f\"Training Accuracy: {train_accuracy:.4f}\")\n","print(f\"Testing Accuracy: {test_accuracy:.4f}\")\n"]},{"cell_type":"code","source":[],"metadata":{"id":"k1PQuMO6jcde"},"execution_count":null,"outputs":[]}],"metadata":{"colab":{"provenance":[],"authorship_tag":"ABX9TyM3Y1LUL1R1mJNsu6pj8cm+"},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}